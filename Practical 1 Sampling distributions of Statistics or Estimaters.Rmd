---
title: "Practical 1 Sampling Distribution of Statistics/Estimater"
author: "Ratnesh D Patil"
date: "`r Sys.Date()`"
output:
  html_document: default
  pdf_document: default
  word_document: default
---
Q1.Conduct a simulation study from N(\(\mu=10,\sigma^2=1)\).For the following statistics
 i)Sample Mean (\(\overline{X}\))
ii) Sample Variance (\(S^2\))
\[ S^2 = \frac{1}{n-1} \sum_{i=1}^{n} (X_i - \overline{X})^2 \]
iii)Sample Median \(\tilde{X}\).
```{r}
n <- c(5,15,30);
mu=10
sigma=1
Mean_T1=Mean_T2=Mean_T3=Mean_T4=var_T1=var_T2=var_T3=var_T4=0
for (i in 1:length(n)) 
  {x <- matrix(rnorm(1000*n[i],mu,sigma),1000)
  X_bar <- apply(x,1,mean)
  T1 <- X_bar
  T2 <- apply(x,1,median)
  T3 <-apply(x,1,var)
  T4 <-((n[i]-1)/n[i])*apply(x,1,var)
  Mean_T1[i] <- mean(T1)
  Mean_T2[i] <- mean(T2)
  Mean_T3[i] <- mean(T3)
  Mean_T4[i] <- mean(T4)
  var_T1[i] <- var(T1)
  var_T2[i] <- var(T2)
  var_T3[i] <- var(T3)
  var_T4[i] <- var(T4)
}
cbind(n,Mean_T1,Mean_T2,Mean_T3,Mean_T4,var_T1,var_T2,var_T3,var_T4)
hist(T1,col=3)
hist(T2,col=2)
hist(T3,col=3)
hist(T4,col=3)

``` 

Q2.Conduct a simulation study from Poisson \(\lambda=2.5\) distribution. For the following statistics:\n
i) sample mean (\(\overline{\lambda}\)) \n
ii) sample variance \(\lambda^2\)
```{r}
n <- c(5,15,30);
Mean_T1=Mean_T2=var_T1=var_T2=0
for (i in 1:length(n)) 
{x <- matrix(rpois(1000*n[i],2.5),1000)
T1 <- apply(x,1, mean)
T2 <- apply(x,1, var)
Mean_T1[i] <- mean(T1)
var_T1[i] <- var(T1)
Mean_T2[i] <- mean(T2)
var_T2[i] <- var(T2)
}
cbind(n,Mean_T1,Mean_T2,var_T1,var_T2)
hist(T1,col=3)
hist(T2,col=2)
```

Q3.Conduct a simulation study from \(U(0,\theta),\theta>0\)  for the following statistics:
i)\(2\overline{X}\) ii) \(X_{(n)}\)
```{r}
n <- c(5,15,30);
Mean_T1=Mean_T2=var_T1=var_T2=0
for (i in 1:length(n)) 
  {x <- matrix(runif(1000*n[i],0,10),1000)
  X_bar <- apply(x,1,mean)
  T1 <- 2*X_bar
  T2 <- apply(x,1, max)
  Mean_T1[i] <- mean(T1)
  var_T1[i] <- var(T1)
  Mean_T2[i] <- mean(T2)
  var_T2[i] <- var(T2)
}
cbind(n,Mean_T1,Mean_T2,var_T1,var_T2)
hist(T1,col=3)
hist(T2,col=2,add=T)
```

Q4. Conduct a simulation study from \(\gamma(\alpha=8,\beta=10)\) for the following statistics: \(T_1 = \tilde{a} = \frac{{m_1^2}}{{m_2 - m_1^2}}\), \(T_{21} = \tilde{\beta} = \frac{{m_2 - m_1^2}}{{m_1}}\) where, \[ m_1 = E(X) = \overline{X} \],  \[ m_2 = E(X^2) = \frac{1}{n} \sum_{i=1}^{n} X_i^2 \] 
             
```{r}
n <- c(5,15,30);
Mean_T1=Mean_T2=var_T1=var_T2=0
for (i in 1:length(n)) 
{x <- matrix(rgamma(1000*n[i],10,1/8),1000) #rgamma(beta,1/alpha)
m1 <- apply(x,1,mean)
m2 <- apply(x^2,1, mean)
T1 <- m1^2/(m2-m1^2)
T2 <- (m2-m1^2)/m1
Mean_T1[i] <- mean(T1)
var_T1[i] <- var(T1)
Mean_T2[i] <- mean(T2)
var_T2[i] <- var(T2)
}
cbind(n,Mean_T1,Mean_T2,var_T1,var_T2)
hist(T1,col=3)
hist(T2,col=2)
```

Q5. Conduct a simulation study from Exponential distribution with location parameter \(\theta\),for the following statistics: i) \(X_{(1)}\) ii) \(\overline{X}-1\)

Solution: Here X~ Exponential distribution with location parameter \(\theta\)
for drawing random sample there is no direct command for this. So we need to use Probability Transformation Theorem i.e. X is continuous then \(F(X)\sim U(0,1)=y\) then \(X = \theta - log(1-y)\sim exp(location=\theta)\)
```{r}
theta <- 2.5;
n <- c(5,15,30);
Mean_T1=Mean_T2=var_T1=var_T2=0
for (i in 1:length(n)){
y <- matrix(runif(1000*n[i],0,1),1000)
x <- theta-log(1-y)
T1 <- apply(x,1,min)
T2 <- apply(x,1,mean)-1
Mean_T1[i] <- mean(T1)
var_T1[i] <- var(T1)
Mean_T2[i] <- mean(T2)
var_T2[i] <- var(T2)}
cbind(n,Mean_T1,Mean_T2,var_T1,var_T2)
hist(T2,col=2)
hist(T1,col=3,add=T)
boxplot(T2,horizontal=T)
boxplot(T1,horizontal=T)
```

Q6. Conduct a simulation study from Exponential distribution with location parameter \(\mu\) and scale parameter \(\sigma\),for the following statistics: 

i) \(X_{(1)}\) 
ii) \(\overline{X}-X_{(1)}\)

solution: for drawing random sample there is no direct command for this. So we need to use Probability Transformation Theorem i.e. X is continuous then \(F(X)\sim U(0,1)=y\) then \(X = \mu -\sigma log(1-y)\sim exp(location=\mu, scale=\sigma)\)
```{r}
mu <- 2.5
sigma <- 2
n <- c(5,15,30);
Mean_T1=Mean_T2=var_T1=var_T2=0
for (i in 1:length(n)){
y <- matrix(runif(1000*n[i],0,1),1000)
x <- mu-sigma*log(1-y)
T1 <- apply(x,1,min)
T2 <- apply(x,1,mean)-T1
Mean_T1[i] <- mean(T1)
var_T1[i] <- var(T1)
Mean_T2[i] <- mean(T2)
var_T2[i] <- var(T2)}
cbind(n,Mean_T1,Mean_T2,var_T1,var_T2)
hist(T2,col=2)
hist(T1,col=3,add=T)
boxplot(T2,horizontal=T)
boxplot(T1,horizontal=T)
```

Q7. Conduct a simulation study from pareto distribution. The PDF of the Pareto distribution: 
\[ f(x) = \frac{\theta}{x^{\theta+1}} \quad \text{for } x > 1, \theta > 0 \] 
for the following statistics:

i) \[ \frac{\bar{X}}{\bar{X}-1} \] 
ii) \[ \frac{n}{\sum_{i=1}^{n} \log(x_i)} \]

Solution: for drawing random sample there is no direct command for this. So we need to use Probability Transformation Theorem i.e. X is continuous then \(F(X)\sim U(0,1)=y\) then \(X = (1-y)^(-1/\theta) \sim\) Pareto distribution.

Note: \[ \frac{n}{\sum_{i=1}^{n} \log(x_i)}=\frac{n}{\sum_{i=1}^{n} Z_i}= \frac{1}{\frac{1}{n} \sum_{i=1}^{n} Z_i}=\frac{1}{\overline{Z}}\]

```{r}
theta <- 2.5;
n <- c(5,15,30);
Mean_T1=Mean_T2=var_T1=var_T2=0
for (i in 1:length(n)){
  y <- matrix(runif(1000*n[i],0,1),1000)
  x <- (1-y)^(-1/theta)
  X_bar <- apply(x,1,mean)
  T1 <- X_bar/(X_bar-1)
  z_bar <- apply(log(x),1,mean)
  T2=1/z_bar
  Mean_T1[i] <- mean(T1)
  var_T1[i] <- var(T1)
  Mean_T2[i] <- mean(T2)
  var_T2[i] <- var(T2)}
cbind(n,Mean_T1,Mean_T2,var_T1,var_T2)
hist(T2,col=2)
hist(T1,col=3)
boxplot(T2,horizontal=T)
boxplot(T1,horizontal=T)
```


